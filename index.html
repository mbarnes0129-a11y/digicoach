<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="theme-color" content="#222">
  <title>DigiCoach (Fan Kit)</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css">
  <script>
    // Register service worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js');
      });
    }
  </script>
</head>
<body>
  <header>
    <div class="brand">üß≠ DigiCoach</div>
    <div class="actions">
      <button id="btnSpeak" class="primary">üîä Speak Status</button>
      <button id="btnMini">üß© Mini HUD</button>
      <button id="btnSettings">‚öôÔ∏è Settings</button>
      <button id="btnExport">‚¨áÔ∏è Export</button>
      <label class="import">
        ‚¨ÜÔ∏è Import <input type="file" id="fileImport" accept=".json" hidden>
      </label>
    </div>
  </header>

  <main class="grid">
    <section class="card avatar">
      <h2 id="companionNameH">Companion</h2>
      <div class="pet-wrap">
        <img id="petImg" alt="Companion avatar" />
      </div>
      <div class="evo-label"><span id="stageName">Stage 1</span></div>
      <div class="stats">
        <div class="stat"><span>Level</span><strong id="level">1</strong></div>
        <div class="stat"><span>XP</span><div class="bar"><div id="xpBar"></div></div><strong id="xpNum">0 / 100</strong></div>
        <div class="stat"><span>Coins</span><strong id="coins">0</strong></div>
        <div class="stat"><span>Mood</span><strong id="mood">üôÇ</strong></div>
      </div>
      <div class="avatar-actions">
        <label class="upload">Stage 1 Image<input type="file" id="imgStage1" accept="image/*" hidden></label>
        <label class="upload">Stage 2 Image<input type="file" id="imgStage2" accept="image/*" hidden></label>
        <label class="upload">Stage 3 Image<input type="file" id="imgStage3" accept="image/*" hidden></label>
      </div>
      <small class="ip-note">Fan kit: bring your <em>own</em> images. Avoid third‚Äëparty IP unless you have rights.</small>
    </section>

    <section class="card tasks">
      <h2>Daily Quests</h2>
      <ul id="taskList" class="task-list"></ul>
      <div class="task-new">
        <input id="taskInput" placeholder="New quest (e.g., 50 push-ups)">
        <button id="addTask">‚ûï Add</button>
      </div>
      <small id="dailyResetNote"></small>
    </section>

    <section class="card coach">
      <h2>Coach</h2>
      <div class="coach-text" id="coachText">Welcome! Tap settings to set your name and companion. Check off quests to earn XP and coins. Your buddy evolves as you level up.</div>
      <div class="coach-cta">
        <button id="btnCheer">üí¨ Cheer Me</button>
        <button id="btnPlan">üóìÔ∏è Plan My Day</button>
      </div>
      <div class="hud-toggle">
        <label><input type="checkbox" id="toggleVibes"> Ambient vibes</label>
      </div>
    </section>
  </main>

  <!-- Mini HUD -->
  <aside id="miniHud" class="mini hidden">
    <div class="mini-top">
      <div class="mini-name"><span id="miniCompanion"></span> ‚Ä¢ Lv <span id="miniLevel"></span></div>
      <button id="miniSpeak">üîä</button>
      <button id="miniClose">‚úñ</button>
    </div>
    <div class="mini-xp"><div id="miniXpBar"></div></div>
    <div class="mini-row">
      <span>ü™ô <span id="miniCoins"></span></span>
      <span><span id="miniMood">üôÇ</span></span>
    </div>
  </aside>

  <!-- Settings Modal -->
  <dialog id="settingsDialog">
    <form method="dialog" class="settings">
      <h3>Settings</h3>
      <label>Trainer Name<input id="trainerName"></label>
      <label>Companion Name<input id="companionName"></label>
      <label>Voice<select id="voiceSelect"><option value="">System Default</option></select></label>
      <div class="row">
        <button value="cancel">Cancel</button>
        <button id="saveSettings" value="ok" class="primary">Save</button>
      </div>
      <p class="tiny">Tip: Add to Home Screen to use like an app. iOS: Share ‚Üí ‚ÄúAdd to Home Screen‚Äù.</p>
    </form>
  </dialog>

  <script>
    window.DIGI_DEFAULTS = {
      stageImages: {
        "1": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIj4KICA8cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiByeD0iODAiIHJ5PSI4MCIgZmlsbD0iIzNkZGM5NyIvPgogIDx0ZXh0IHg9IjUwJSIgeT0iNTQlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjIyMCI+IPCfkKMgPC90ZXh0Pgo8L3N2Zz4=",
        "2": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIj4KICA8cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiByeD0iODAiIHJ5PSI4MCIgZmlsbD0iIzAwYmNkNCIvPgogIDx0ZXh0IHg9IjUwJSIgeT0iNTQlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjIyMCI+IPCfkLIgPC90ZXh0Pgo8L3N2Zz4=",
        "3": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIj4KICA8cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiByeD0iODAiIHJ5PSI4MCIgZmlsbD0iIzY3M2FiNyIvPgogIDx0ZXh0IHg9IjUwJSIgeT0iNTQlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjIyMCI+IPCfkIkgPC90ZXh0Pgo8L3N2Zz4="
      }
    };
  </script>
  <script src="app.js"></script>
</body>
</html>
